---
layout: default
title: 5.1 シミュレーション結果の確認と波形評価
---

---

# 🧪 5.1 シミュレーション結果の確認と波形評価  
**Simulation Results and Waveform Evaluation**

---

本節では、PoCブロック（FSM、MUX、Adder）を対象に行った **Verilogシミュレーション** の結果を、波形ファイル（`.vcd`）を通じて**可視化・検証**する方法を学びます。  
単に出力信号が出たかどうかではなく、**タイミング関係・フラグの遷移・信号の整合性**を総合的に評価します。

---

## 🧰 使用ツール｜Tools Used

| 種類｜Type | ツール｜Tool |
|--------|--------------------------|
| **シミュレータ** | `Icarus Verilog (iverilog, vvp)` |
| **波形ビューア** | `GTKWave`（`.vcd` ファイル表示） |

---

## 🗂️ 対象ブロックと波形ファイル｜Target Blocks & Waveform Files

| ブロック｜Block | 波形ファイル｜VCD File | 検証目的｜Purpose |
|-------------|------------------|--------------------------|
| **FSM**     | `fsm.vcd`        | 状態遷移と完了フラグの確認 |
| **MUX**     | `mux.vcd`        | 選択信号と出力の一致確認 |
| **Adder**   | `adder.vcd`      | 入力A/Bと加算結果の検証 |

---

## 🔍 1. GTKWaveでの表示方法｜How to View in GTKWave

以下のコマンドでVCDファイルを開きます：

```sh
gtkwave fsm.vcd
```

もしくは `Makefile` に `gtkwave` 起動を組み込んでおくことで、実行後に自動表示も可能です。

### ✅ 表示の工夫｜Display Tips

- `clk`, `rst_n`, `start`, `flag_done` などの**主要信号を上部に表示**
- `zoom fit` を使って全波形を一括表示
- グループ分けや色変更も活用可能

---

## 🔎 2. 検証観点｜Key Evaluation Points

### 🎯 FSM（状態遷移）

- `clk` 立ち上がりで状態が変化しているか
- `start` により `IDLE → LOAD` に遷移しているか
- `flag_done` が `EXEC` 状態で `1` になっているか
- `rst_n` によって状態が `IDLE` に初期化されているか

### 🔀 MUX（選択回路）

- `SEL = 0` のとき、出力 `Y = A`
- `SEL = 1` のとき、出力 `Y = B`
- `SEL` の変化に出力が追従しているか

### ➕ Adder（加算器）

- `A + B` が `SUM` に正しく反映されているか
- 桁あふれ時の `COUT` が `1` になるか

---

## 💡 アサーションの活用（発展）｜Assertion for Robust Testing

簡単な `assert` 文を `always` ブロック内に組み込むことで、**論理的整合性の自動検出**が可能です。

```verilog
always @(posedge clk) begin
    if (state == DONE) assert(flag_done == 1);
end
```

🔧 → **バグや動作異常を波形に頼らず検出可能**

---

## 📘 教材的まとめ｜Summary

波形確認は「設計が動作しているかどうか」を確かめる**最初の関門**です。  
ここでの観察力と検証スキルが、後続の物理設計や製品開発の**信頼性向上**に直結します。

---

## 🔗 次節への接続｜Next Section

📁 [5.2 面積・タイミングの評価とレポート解釈](5.2_area_and_timing_report.md)  
**→ OpenLaneレポートをもとに、設計実装の効率や性能を数値的に評価します。**
